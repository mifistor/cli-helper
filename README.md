# CLI Helper

CLI Helper - это обретка, которая использует OpenAI API чтобы не покидая терминал спросить что-то короткое у AI.

Например, вам надо создать архив директории, а вы не помните команду на память. Можно вызвать man zip|tar|gzip и тратить несколько минут на чтение опций, а можно просто вызвать cli-helper "добавить директорию ./folder в folder.tar.gzip" и через мгновение у вас на экране и в буфере обмена будет решение. 

## Особенности

- Генерация команд терминала на основе текстового запроса
- Поддержка различных моделей OpenAI
- Предупреждение о потенциально опасных командах
- Настраиваемый API endpoint
- Автоматическое копирование результата в буфер обмена (для macOS и Linux)
- Поддержка локализации (автоматическое определение языка системы)
- Простой и удобный интерфейс командной строки

## Установка

### Предварительные требования

- Go 1.16 или выше
- OpenAI API ключ

### Сборка из исходников

1. Клонируйте репозиторий:
   ```
   git clone https://github.com/mifistor/cli-helper.git
   cd cli-helper
   ```

2. Установите зависимости:
   ```
   make deps
   ```

3. Соберите проект:
   ```
   make build
   ```

4. Установите бинарный файл:

   a. В домашнюю директорию (рекомендуется):
   ```
   make install
   ```
   После установки добавьте `~/.cli-helper` в переменную PATH:
   ```
   echo 'export PATH="$HOME/.cli-helper:$PATH"' >> ~/.bashrc  # для Bash
   # или
   echo 'export PATH="$HOME/.cli-helper:$PATH"' >> ~/.zshrc   # для Zsh
   ```
   И перезагрузите конфигурацию оболочки:
   ```
   source ~/.bashrc  # для Bash
   # или
   source ~/.zshrc   # для Zsh
   ```

   b. В систему (требует sudo):
   ```
   sudo make install-system
   ```

## Настройка

Создайте файл `.env` в одном из следующих мест:

- В текущей рабочей директории
- В директории, где находится исполняемый файл
- В домашней директории пользователя: `~/.cli-helper/.env`

Содержимое файла `.env`:

```
OPENAI_API_KEY="ваш_api_ключ"
OPENAI_API_BASE="https://api.openai.com/v1" # опционально, если вы используете другой endpoint
OPENAI_MODEL="gpt-3.5-turbo" # опционально, модель по умолчанию
PROMPT_TEMPLATE="Я хочу выполнить действие в терминале в операционной системе $CURRENT_OS. Ответь ТОЛЬКО командой без пояснений. Если команда опасная (может удалить данные или навредить системе), добавь предупреждение 'WARNING: ' перед командой. Запрос: $QUERY Команда:" # опционально, шаблон промта
```

Переменные в шаблоне промта:
- `$CURRENT_OS` - автоматически заменяется на текущую операционную систему (macOS, Linux, Windows)
- `$QUERY` - заменяется на ваш запрос

## Локализация

CLI Helper автоматически определяет язык системы и использует соответствующие переводы. В настоящее время поддерживаются следующие языки:

- Английский (en)
- Русский (ru)

### Добавление нового языка

Чтобы добавить новый язык, создайте файл `locales/<код_языка>.json` по образцу существующих файлов локализации. Например, для добавления французского языка создайте файл `locales/fr.json`.

```json
{
  "usage_error": "Erreur: Une requête est nécessaire",
  "usage_help": "Utilisation: cli-helper [--model MODÈLE] [--copy] REQUÊTE",
  ...
}
```

После добавления нового файла локализации, пересоберите проект с помощью `make build` или `make install`.

## Использование

### Базовое использование

```
cli-helper "как найти все файлы с расширением .txt в текущей директории"
```

### Указание модели

```
cli-helper --model gpt-4 "как найти все файлы с расширением .txt в текущей директории"
```

### Отключение копирования в буфер обмена

```
cli-helper --no-copy "как найти все файлы с расширением .txt в текущей директории"
```

### Использование через Makefile

```
make run ARGS="как найти все файлы с расширением .txt в текущей директории"
```

### Использование через Makefile с отключением копирования в буфер обмена

```
make run COPY="--no-copy" ARGS="как найти все файлы с расширением .txt в текущей директории"
```

## Примеры

### Пример 1: Поиск файлов

Запрос:
```
cli-helper "найти все файлы, измененные за последние 7 дней"
```

Ответ:
```
find . -type f -mtime -7
```

По умолчанию команда автоматически копируется в буфер обмена:
```
cli-helper "найти все файлы, измененные за последние 7 дней"
```

Ответ:
```
find . -type f -mtime -7
Команда скопирована в буфер обмена
```

### Пример 2: Работа с процессами

Запрос:
```
cli-helper "убить все процессы python"
```

Ответ:
```
WARNING: killall python
```

## Разработка

### Структура проекта

- `main.go` - основной файл программы
- `i18n.go` - модуль локализации
- `locales/` - директория с файлами локализации
  - `en.json` - английский язык
  - `ru.json` - русский язык
- `example/help.go` - пример использования OpenAI API
- `Makefile` - файл для удобной сборки и управления проектом

### Доступные команды Makefile

- `make build` - Сборка бинарного файла
- `make deps` - Установка зависимостей
- `make install` - Установка бинарного файла в ~/.cli-helper/
- `make install-system` - Установка бинарного файла в /usr/local/bin (требует sudo)
- `make clean` - Очистка сборки
- `make test` - Запуск тестов
- `make example` - Запуск примера
- `make run ARGS="ваш запрос"` - Запуск основной программы с аргументами
- `make run COPY="--no-copy" ARGS="ваш запрос"` - Запуск с отключением копирования в буфер обмена
- `make help` - Показать справку

## Лицензия

MIT
